## 5.31 동기식 처리 모델 vs 비동기식 처리 모델



### 1. 동기식 처리모델 

동기식 처리 모델은 직렬적으로 태스크(task)를 수행한다. 

즉, 태스크는 순차적으로 실행되며 어떤 작업이 수행중이면 다음 작업은 대기하게 된다.

### 2. 비동기식 처리모델

비동기식 처리 모델은 병렬적으로 태스크를 수행한다.

즉, 태스크가 종료되지 않은 상태라 하더라도 대기하지 않고 다음 태스크를 실행한다.

자바스크립트의 대부분의 DOM 이벤트 핸들러와 Timer 함수, Ajax 요청은 비동기식 처리 모델로 동작한다.



아래 코드는 비동기식으로 동작하는 코드이다.

```javascript
function func1() {
	console.log('func1');
	func2();
}

function func2() {
	setTimeout(function() {
		console.og('func2');
	}, 0);
	
	func3();
}

function func3() {
	console.log('func3');
}

func1();
```

함수 func1이 호출되면 함수 func1은 Call Stack에 쌓인다. 그리고 함수 func1은 함수 func2을 호출하므로 함수 func2가 Call Stack에 쌓이고 setTimeout가 호출된다. setTimeout의 콜백함수는 즉시 실행되지 않고 지정 대기 시간만큼 기다리다가 “tick” 이벤트가 발생하면 태스크 큐로 이동한 후 Call Stackㅣ 비어졌을 때 Call Stack으로 이동되어 실행된다.



---------------------------------------------

## 5.32 Event 이벤트

### 1. Introduction

- 이벤트 핸들러란?

  이벤트가 발생하면 그에 맞는 반응을 하여야 한다. 이를 위해 이벤트는 일반적으로 함수에 연결되며 그 함수는 이벤트가 발생하기 전에는 실행되지 않다가 이벤트가 발생하면 실행된다. 이 함수를 이벤트 핸들러라 하며 이벤트에 대응하는 처리를 기술한다.

------------

### 2. 이벤트  루프와 동시성

브라우저는 단일쓰레드방식으로 동작하지만 이벤트 루프덕에 많은 task가 동시에 처리되는 것처럼 느낌

-------

- 자바스크립트의 2개의 영역

  1. Call Stack(호출 스택)

     작업이 요청되면 요청된 작업은 순차적으로 Call Stack에 쌓이게 되고 순차적으로 실행된다.

     자바스크립트는 단 하나의 Call Stack을 사용하기 때문에 해당 task가 종료하기 전까지는 다른 어떤 task

     도 수행될수 없다

     

  2. Heap

     동적으로 생성된 객체 인스턴스가 할당되는 영역이다.

------

자바스크립트 엔진은 단순히 작업이 요청되면 Call Stack을 사용하여 요청된 작업을 순차적으로 실행할 뿐

동시성을 지원하기 위해 비동기 요청 처리는 자바스크립트 엔진을 구동하는 환경 브라우저가 담당



- 용어 정리

  1. Event Queue(Task Queue)

     비동기 처리 함수의 콜백 함수, 비동기식 이벤트 핸들러, Timer 함수의 콜백함수가 보관되는 영역으로 이

     벤트 루프에 의해 특정 시점에 순차적으로 Call Stack으로 이동되어 실행된다.

     

  2. Event Loop(이벤트 루프)

     Call Stack 내에서 현재 실행중인 task가 있는지 그리고 Event Queue에 task가 있는지 반복하여 확인한

     다. 만약 Call Stack이 비어있다면 Event Queue 내의 task가 Call Stack으로 이동하고 실행된다.

--------

### 3. 이벤트의 종류



#### 3.1 UI Event

| Event  |                         Description                          |
| ------ | :----------------------------------------------------------: |
| load   |               웹페이지의 로드가 완료되었을 때                |
| unload |  웹페이지가 언로드될 때 (주로 새로운 페이지를 요청한 경우)   |
| error  | 브라우저가 자바스크립트 오류를 만났거나 요청한 자원이 존재하지 않는경우 |
| resize |               브라우저 창의 크기가 조절했을 때               |
| scroll |            사용자가 페이지를 위아래로 스크롤할 때            |
| select |                     텍스트를 선택했을 때                     |



#### 3.2 Keyboard Event

|  Event   |      Description       |
| :------: | :--------------------: |
| keydown  |  키를 누르고 있을 때   |
|  keyup   | 누르고 있던 키를 뗄 때 |
| keypress |  키를 누르고 뗏을 때   |



#### 3.3 Mouse Event

|   Event   |           Description            |
| :-------: | :------------------------------: |
|   click   |    마우스 버튼을 클릭했을 때     |
|  dbclick  |  마우스 버튼을 더블 클릭했을 때  |
| mousedown |   마우스 버튼을 누르고 있을 때   |
|  mouseup  | 누르고 있던 마우스 버튼을 뗄 때  |
| mousemove |        마우스를 움직일 때        |
| mouseover |  마우스를 요소 위로 움직였을 때  |
| mouseout  | 마우스를 요소 밖으로 움직였을 때 |



#### 3.4 Focus Event 

|      Event      |        Description        |
| :-------------: | :-----------------------: |
| focus / focusin | 요소가 포커스를 얻었을 때 |
| blur / focusout | 요소가 포커스를 잃었을 때 |



#### 3.5 Form Event

| Event  |                         Description                         |
| :----: | :---------------------------------------------------------: |
| input  |        input 또는 textarea 요소의 값이 변경되었을 때        |
|        | contenteditable 어트리뷰트를 가진 요소의 값이 변경되었을 때 |
| change |  select box, checkbox, radio button의 상태가 변경되었을 때  |
| submit |              form을 submit할 때(버튼 또는 키)               |
| reset  |                   reset 버튼을 클릭할 때                    |



#### 3.6 Clipboard Event 

| Event |      Description       |
| :---: | :--------------------: |
|  cut  | 콘텐츠를 잘라내기할 때 |
| copy  |   콘텐츠를 복사할 때   |
| paste | 콘텐츠를 붙여넣기할 때 |



### 4. 이벤트 핸들러 등록 방법



#### 4.1 인라인 이벤트 핸들러 방식

HTML 요소의 이벤트 핸들러 어트리뷰트에 이벤트 핸들러를 등록하는 방법



#### 4.2 이벤트 핸들러 프로퍼티 방식

인라인 이벤트 핸들러 방식처럼 HTML과 Javascript가 뒤섞이는 문제는 해결할 수 있는 방식

이벤트 핸들러 프로퍼티에 하나의 이벤트 핸들러만을 바인딩할 수 있다는 단점이 있다.



#### 4.3 addEventListener 메소드 방식

addEventListener 메소드를 이용하여 대상 DOM 요소에 이벤트를 바인딩하고 해당 이벤트가 발생했을 때 실행될 콜백 함수를 지정한다.



- addEventListener 함수 방식이 이전 방식보다 나은 장점
  1. 하나의 이벤트에 대해 하나 이상의 이벤트 핸들러를 추가할 수 있다.
  2. 캡처링과 버블링을 지원한다.
  3. HTML 요소뿐만아니라 모든 DOM 요소(HTML, XML, SVG)에 대해 동작한다. 브라우저는 웹 문서(HTML, XML, SVG)를 로드한 후, 파싱하여 DOM을 생성한다.
  4. 



### 5. 이벤트 핸들러 함수 내부의 this



#### 5.1 인라인 이벤트 핸들러 방식

인라인 이벤트 핸들러 방식의 경우, 이벤트 핸들러는 일반 함수로서 호출되므로 이벤트 핸들러 내부의 this는 전역 객체 window를 가리킨다.



#### 5.2 이벤트 핸들러 프로퍼티 방식

이벤트 핸들러 프로퍼티 방식에서 이벤트 핸들러는 메소드이므로 이벤트 핸들러 내부의 this는 이벤트에 바인딩된 요소를 가리킨다. 



#### 5.3 addEventListener 메소드 방식

addEventListener 메소드에서 지정한 이벤트 핸들러는 콜백 함수이지만 이벤트 핸들러 내부의 this는 이벤트 리스너에 바인딩된 요소를 가리킨다. 



### 6. 이벤트의 흐름

계층적 구조에 포함되어 있는 HTML 요소에 이벤트가 발생할 경우 연쇄적 반응이 일어난다. 

즉, 이벤트가 전파되는데 전파 방향에 따라 버블링과 캡처리으로 구분할 수 있다.



- 버블링 

  자식 요소에서 발생한 이벤트가 부모 요소로 전파되는 것



- 캡처링

  자식 요소에서 발생한 이벤트가 부모 요소부터 시작하여 이벤트를 발생시킨 자식 요소까지 도달하는 것



TIP! 

- 버블링과 캡처링은 둘 중에 하나만 발생하는 것이 아니라 캡처링부터 시작하여 버블링으로 종료한다는 것
- addEventListener 메소드의 세번째 매개변수에 true를 설정하면 캡처링으로 전파되는 이벤트를 캐치하고 false 또는 미설정하면 버블링으로 전파되는 이벤트를 캐치한다.



### 7. Event 객체

event 객체는 이벤트를 발생시킨 요소와 발생한 이벤트에 대한 유용한 정보를 제공한다. 이벤트가 발생하면 event 

객체는 동적으로 생성되며 이벤트를 처리할 수 있는 이벤트 핸들러에 인자로 전달된다.



#### 7.1 Event Property



##### 7.1.1 Event.target

실제로 이벤트를 발생시킨 요소를 가리킨다.



##### 7.1.2 Event.currentTarget

이벤트에 바인딩된 DOM 요소를 가리킨다. 즉, addEventListener 앞에 기술된 객체를 가리킨다.



##### 7.1.3 Event.type

발생한 이벤트의 종류를 나타내는 문자열을 반환한다.



##### 7.1.4 Event.cancelable

요소의 기본 동작을 취소시킬수 있는지 여부를 나타낸다. 



##### 7.1.5 Event.eventPhase

이벤트 흐름상에서 어느 단계에 있는지를 반환한다.

| 반환값 |    의미     |
| :----: | :---------: |
|   0    | 이벤트 없음 |
|   1    | 캡쳐링 단계 |
|   2    |    타깃     |
|   3    | 버블링 단계 |





### 8. Event Delegation (이벤트 위임)

- 이벤트 위임이란?

다수의 자식 요소에 각각 이벤트 핸들러를 바인딩하는 대신 하나의 부모 요소에 이벤트 핸들러를 바인딩하는 방법



### 9. 기본 동작의 변경

이벤트 객체는 요소의 기본 동작과 요소의 부모 요소들이 이벤트에 대응하는 방법을 변경하기 위한 메소드를 가지고 있다.



#### 9.1 Event.preventDefault()

폼을 submit하거나 링크를 클릭하면 다른 페이지로 이동하게 된다. 이와 같은 요소가 가지고 있는 기본 동작을 중단시키기 위한 메소드가 preventDefault()



#### 9.2 Event.stopPropagation()

어느 한 요소를 이용하여 이벤트를 처리한 후 이벤트가 부모 요소로 이벤트가 전파되는 것을 중단시키기 위한 메소드

부모 요소에 동일한 이벤트에 대한 다른 핸들러가 지정되어 있을 경우 사용됨



#### 9.3 preventDefault & stopPropagation

기본 동작의 중단과 버블링 또는 캡처링의 중단을 동시에 실시하는 방법

